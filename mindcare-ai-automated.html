<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MindCare AI - Intelligent Mental Health Companion</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366F1;
            --primary-dark: #4F46E5;
            --secondary: #10B981;
            --accent: #F59E0B;
            --danger: #EF4444;
            --info: #3B82F6;
            --purple: #8B5CF6;
            --pink: #EC4899;
            --gold: #FFD700;
            --bg-main: #F9FAFB;
            --bg-card: #FFFFFF;
            --text-dark: #111827;
            --text-medium: #6B7280;
            --text-light: #9CA3AF;
            --border: #E5E7EB;
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-main);
            color: var(--text-dark);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            padding-bottom: 80px;
        }

        /* Header with AI Badge */
        header {
            background: linear-gradient(135deg, var(--primary), var(--purple));
            color: white;
            padding: 25px 0;
            box-shadow: var(--shadow-lg);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .ai-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: particleFloat 20s linear infinite;
            pointer-events: none;
        }

        @keyframes particleFloat {
            from { transform: translateY(0); }
            to { transform: translateY(-50px); }
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            position: relative;
            z-index: 1;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .logo {
            font-size: 1.8em;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .ai-badge {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: #000;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.5em;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* AI Insight Card */
        .ai-insight-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .ai-insight-card::before {
            content: 'ü§ñ';
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 3em;
            opacity: 0.2;
        }

        .ai-insight-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .ai-thinking {
            display: inline-block;
            animation: rotate 2s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .insight-text {
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .insight-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .insight-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.4);
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            font-weight: 600;
        }

        .insight-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        /* Smart Recommendations */
        .smart-recommendations {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .recommendation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .auto-label {
            background: linear-gradient(135deg, #10B981, #059669);
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .recommendation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }

        .recommendation-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            border: 2px solid transparent;
        }

        .recommendation-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary);
        }

        .rec-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--accent);
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.7em;
            font-weight: bold;
        }

        .rec-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .rec-title {
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 8px;
            color: var(--text-dark);
        }

        .rec-reason {
            font-size: 0.9em;
            color: var(--text-medium);
            margin-bottom: 10px;
        }

        .ai-tip {
            background: rgba(99, 102, 241, 0.1);
            border-left: 3px solid var(--primary);
            padding: 10px;
            margin-top: 10px;
            font-size: 0.85em;
            font-style: italic;
            color: var(--primary-dark);
            border-radius: 5px;
        }

        .ai-tip::before {
            content: 'üí° Pro Tip: ';
            font-weight: bold;
            font-style: normal;
        }

        /* Interactive Exercise Container */
        .interactive-exercise {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .exercise-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .control-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .control-btn:disabled {
            background: var(--text-light);
            cursor: not-allowed;
            transform: none;
        }

        /* Breathing Visualizer */
        .breathing-visualizer {
            width: 300px;
            height: 300px;
            margin: 30px auto;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .breathing-circle {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--purple));
            position: absolute;
            transition: all 4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 40px rgba(99, 102, 241, 0.4);
        }

        .breathing-circle.inhale {
            transform: scale(1.5);
        }

        .breathing-circle.exhale {
            transform: scale(0.8);
        }

        .breathing-text {
            font-size: 1.5em;
            font-weight: bold;
            color: white;
            z-index: 1;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .breathing-counter {
            text-align: center;
            font-size: 1.2em;
            margin-top: 20px;
            color: var(--text-medium);
        }

        /* Interactive Thought Challenge */
        .thought-challenge {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }

        .thought-input {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 1em;
            margin-bottom: 15px;
            resize: vertical;
            min-height: 80px;
        }

        .reframe-result {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
            border-left: 4px solid var(--secondary);
        }

        /* Stress Ball Game */
        .stress-ball-game {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 15px;
            margin: 20px 0;
        }

        .stress-ball {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 20px auto;
            cursor: pointer;
            transition: all 0.1s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            position: relative;
            user-select: none;
        }

        .stress-ball:active {
            transform: scale(0.85);
        }

        .stress-ball::after {
            content: 'üéØ';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3em;
        }

        .squeeze-counter {
            font-size: 2em;
            font-weight: bold;
            color: var(--primary);
            margin-top: 15px;
        }

        /* Progress Tracker */
        .progress-tracker {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .progress-stat {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: var(--bg-main);
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: var(--border);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), var(--primary));
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        /* Mini Learning Cards */
        .mini-learning {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .learning-card {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .learning-card:hover {
            transform: translateX(10px);
            box-shadow: var(--shadow-lg);
        }

        .learning-title {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .learning-content {
            display: none;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid rgba(0,0,0,0.1);
        }

        .learning-content.active {
            display: block;
        }

        /* Mood Prediction */
        .mood-prediction {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--shadow-lg);
        }

        .prediction-chart {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
        }

        /* Navigation */
        nav {
            background: var(--bg-card);
            border-radius: 15px;
            box-shadow: var(--shadow-md);
            margin-bottom: 25px;
            padding: 15px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            position: sticky;
            top: 20px;
            z-index: 100;
            border: 1px solid var(--border);
        }

        .nav-btn {
            background: transparent;
            color: var(--text-medium);
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            background: var(--bg-main);
            color: var(--primary);
        }

        .nav-btn.active {
            background: var(--primary);
            color: white;
        }

        /* Sections */
        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--bg-main);
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .close-modal:hover {
            background: var(--danger);
            color: white;
        }

        /* Buttons */
        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 1em;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: var(--secondary);
        }

        .btn-secondary:hover {
            background: #059669;
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .mb-2 {
            margin-bottom: 20px;
        }

        .mt-2 {
            margin-top: 20px;
        }

        h2 {
            font-size: 1.5em;
            margin-bottom: 15px;
            color: var(--text-dark);
        }

        h3 {
            font-size: 1.2em;
            margin-bottom: 10px;
            color: var(--text-dark);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .recommendation-grid {
                grid-template-columns: 1fr;
            }

            .breathing-visualizer {
                width: 250px;
                height: 250px;
            }

            .breathing-circle {
                width: 150px;
                height: 150px;
            }
        }

        /* Animation for new features */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in-up {
            animation: fadeInUp 0.5s ease;
        }
    </style>
</head>
<body>
    <header>
        <div class="ai-particles"></div>
        <div class="header-content">
            <div class="header-top">
                <div class="logo">
                    üß† MindCare AI
                    <span class="ai-badge">AI POWERED</span>
                </div>
                <div style="text-align: right;">
                    <div style="font-size: 0.9em; opacity: 0.9;">Level <span id="userLevel">1</span></div>
                    <div style="font-size: 0.8em; opacity: 0.8;"><span id="userPoints">0</span> XP</div>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- AI Insight Card -->
        <div class="ai-insight-card fade-in-up">
            <div class="ai-insight-header">
                <span class="ai-thinking">ü§ñ</span>
                <h3>AI Insight of the Day</h3>
            </div>
            <div class="insight-text" id="aiInsightText">
                Analyzing your patterns...
            </div>
            <div class="insight-actions">
                <button class="insight-btn" onclick="refreshInsight()">üîÑ New Insight</button>
                <button class="insight-btn" onclick="explainInsight()">‚ùì Explain More</button>
            </div>
        </div>

        <!-- Navigation -->
        <nav>
            <button class="nav-btn active" onclick="showSection('home')">üè† Home</button>
            <button class="nav-btn" onclick="showSection('exercises')">üßò Interactive Exercises</button>
            <button class="nav-btn" onclick="showSection('games')">üéÆ Stress Relief Games</button>
            <button class="nav-btn" onclick="showSection('learning')">üìö Smart Learning</button>
            <button class="nav-btn" onclick="showSection('insights')">üìä AI Insights</button>
        </nav>

        <!-- Home Section -->
        <div id="home" class="section active">
            <!-- Smart Recommendations -->
            <div class="smart-recommendations">
                <div class="recommendation-header">
                    <h2>üéØ Smart Recommendations For You</h2>
                    <span class="auto-label">‚ö° AUTO-GENERATED</span>
                </div>
                <div class="recommendation-grid" id="recommendationGrid">
                    <!-- Recommendations will be inserted here -->
                </div>
            </div>

            <!-- Progress Tracker -->
            <div class="progress-tracker">
                <h2>üìà Your Progress</h2>
                <div class="progress-stat">
                    <div>
                        <div style="font-weight: 600;">Daily Streak</div>
                        <div style="font-size: 0.9em; color: var(--text-medium);">Keep it going!</div>
                    </div>
                    <div style="font-size: 1.5em; font-weight: bold; color: var(--accent);">
                        <span id="streakCount">0</span> days üî•
                    </div>
                </div>
                <div class="progress-stat">
                    <div style="width: 100%;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="font-weight: 600;">Exercises Completed Today</span>
                            <span id="dailyExerciseCount">0/3</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="dailyProgressFill" style="width: 0%;"></div>
                        </div>
                    </div>
                </div>
                <div class="progress-stat">
                    <div style="width: 100%;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="font-weight: 600;">Weekly Goal</span>
                            <span id="weeklyExerciseCount">0/15</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="weeklyProgressFill" style="width: 0%;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interactive Exercises Section -->
        <div id="exercises" class="section">
            <h2 class="text-center">üßò Interactive Exercises</h2>

            <!-- Breathing Exercise -->
            <div class="interactive-exercise">
                <h3 class="text-center">Deep Breathing Guide</h3>
                <div class="ai-tip">Start with 3 rounds. Studies show even 60 seconds of deep breathing can reduce cortisol by 15%.</div>

                <div class="breathing-visualizer">
                    <div class="breathing-circle" id="breathingCircle"></div>
                    <div class="breathing-text" id="breathingText">Ready</div>
                </div>

                <div class="breathing-counter">
                    Rounds completed: <span id="breathingRounds">0</span>/3
                </div>

                <div class="exercise-controls">
                    <button class="control-btn" id="startBreathing" onclick="startBreathing()">‚ñ∂Ô∏è Start</button>
                    <button class="control-btn" id="pauseBreathing" onclick="pauseBreathing()" disabled>‚è∏Ô∏è Pause</button>
                    <button class="control-btn" onclick="resetBreathing()">üîÑ Reset</button>
                </div>

                <div class="ai-tip mt-2">
                    <strong>Real-time tip:</strong> <span id="breathingTip">Click start to begin your breathing exercise.</span>
                </div>
            </div>

            <!-- Thought Reframing -->
            <div class="interactive-exercise">
                <h3>üí≠ AI-Powered Thought Reframing</h3>
                <div class="ai-tip">Cognitive restructuring is one of the most effective CBT techniques. Try it now!</div>

                <div class="thought-challenge">
                    <label style="font-weight: 600; display: block; margin-bottom: 10px;">
                        What negative thought is bothering you?
                    </label>
                    <textarea
                        class="thought-input"
                        id="negativeThought"
                        placeholder="Example: I always mess things up..."
                    ></textarea>

                    <button class="btn btn-secondary" onclick="reframeThought()">
                        ü§ñ AI Reframe This Thought
                    </button>

                    <div id="reframeResult" class="reframe-result hidden">
                        <h4>‚ú® Alternative Perspective:</h4>
                        <p id="reframedThought"></p>
                        <div class="ai-tip mt-2" id="reframeTip"></div>
                    </div>
                </div>
            </div>

            <!-- Progressive Muscle Relaxation -->
            <div class="interactive-exercise">
                <h3>üí™ Guided Progressive Muscle Relaxation</h3>
                <div class="ai-tip">This technique reduces physical tension in 10-15 minutes. Best done before bed or during high stress.</div>

                <div style="text-align: center; padding: 20px;">
                    <div style="font-size: 3em; margin-bottom: 15px;" id="pmrEmoji">üßò</div>
                    <div style="font-size: 1.2em; font-weight: 600; margin-bottom: 10px;" id="pmrInstruction">
                        Click start to begin
                    </div>
                    <div style="color: var(--text-medium);" id="pmrArea">Ready when you are</div>
                    <div style="margin-top: 15px;">Step <span id="pmrStep">0</span>/8</div>
                </div>

                <div class="exercise-controls">
                    <button class="control-btn" id="startPMR" onclick="startPMR()">‚ñ∂Ô∏è Start</button>
                    <button class="control-btn" onclick="nextPMRStep()">‚è≠Ô∏è Next</button>
                    <button class="control-btn" onclick="resetPMR()">üîÑ Reset</button>
                </div>

                <div class="ai-tip mt-2" id="pmrTip">
                    Starting tip: Find a quiet space where you won't be disturbed. Sit or lie down comfortably.
                </div>
            </div>
        </div>

        <!-- Stress Relief Games Section -->
        <div id="games" class="section">
            <h2 class="text-center">üéÆ Stress Relief Games</h2>

            <!-- Stress Ball -->
            <div class="stress-ball-game">
                <h3>Digital Stress Ball</h3>
                <div class="ai-tip">Repetitive actions can help regulate your nervous system. Aim for 20 squeezes!</div>

                <div class="stress-ball" id="stressBall" onclick="squeezeBall()"></div>

                <div class="squeeze-counter">
                    <span id="squeezeCount">0</span> squeezes
                </div>

                <div class="ai-tip mt-2" id="ballTip">
                    Squeeze the ball by tapping or clicking. Each squeeze releases a little tension!
                </div>
            </div>

            <!-- Breathing Bubble Game -->
            <div class="interactive-exercise">
                <h3>ü´ß Breathing Bubble Game</h3>
                <div class="ai-tip">Match your breath to the bubble's size. This gamifies breath control training!</div>

                <canvas id="bubbleCanvas" width="400" height="400" style="display: block; margin: 20px auto; border-radius: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></canvas>

                <div class="exercise-controls">
                    <button class="control-btn" onclick="startBubbleGame()">‚ñ∂Ô∏è Start Game</button>
                    <button class="control-btn" onclick="stopBubbleGame()">‚èπÔ∏è Stop</button>
                </div>

                <div class="text-center mt-2">
                    Score: <span id="bubbleScore">0</span> points
                </div>
            </div>
        </div>

        <!-- Smart Learning Section -->
        <div id="learning" class="section">
            <h2>üìö Personalized Learning Path</h2>
            <div class="ai-tip mb-2">Based on your progress, here's what we recommend learning next:</div>

            <div class="mini-learning" id="learningContainer">
                <!-- Learning cards will be inserted here -->
            </div>
        </div>

        <!-- AI Insights Section -->
        <div id="insights" class="section">
            <h2>üìä AI-Powered Insights</h2>

            <!-- Mood Prediction -->
            <div class="mood-prediction">
                <h3>üîÆ Mood Trend Prediction</h3>
                <p>Based on your patterns over the last 7 days, here's what we predict:</p>
                <div class="prediction-chart">
                    <canvas id="moodChart"></canvas>
                </div>
                <div class="ai-tip mt-2">
                    Your mood tends to improve on days when you complete breathing exercises before 10 AM.
                </div>
            </div>

            <!-- Activity Effectiveness -->
            <div class="progress-tracker">
                <h3>‚ö° Activity Effectiveness Analysis</h3>
                <div style="margin-top: 15px;">
                    <div class="progress-stat">
                        <div>
                            <div style="font-weight: 600;">Breathing Exercises</div>
                            <div style="font-size: 0.85em; color: var(--text-medium);">
                                Most effective at 7 AM and 9 PM
                            </div>
                        </div>
                        <div style="font-size: 1.3em; font-weight: bold; color: var(--secondary);">92%</div>
                    </div>
                    <div class="progress-stat">
                        <div>
                            <div style="font-weight: 600;">Thought Reframing</div>
                            <div style="font-size: 0.85em; color: var(--text-medium);">
                                Try pairing with journaling
                            </div>
                        </div>
                        <div style="font-size: 1.3em; font-weight: bold; color: var(--secondary);">85%</div>
                    </div>
                    <div class="progress-stat">
                        <div>
                            <div style="font-weight: 600;">Muscle Relaxation</div>
                            <div style="font-size: 0.85em; color: var(--text-medium);">
                                Best results before sleep
                            </div>
                        </div>
                        <div style="font-size: 1.3em; font-weight: bold; color: var(--secondary);">88%</div>
                    </div>
                </div>
            </div>

            <!-- Best Time Recommendations -->
            <div class="smart-recommendations">
                <h3>‚è∞ Optimal Activity Times</h3>
                <div style="margin-top: 15px; padding: 20px; background: var(--bg-main); border-radius: 10px;">
                    <p style="margin-bottom: 15px;">Based on your activity patterns and mood data:</p>
                    <ul style="list-style: none; padding: 0;">
                        <li style="padding: 10px; margin-bottom: 10px; background: white; border-radius: 8px; border-left: 4px solid var(--primary);">
                            <strong>üåÖ Morning (7-9 AM):</strong> Breathing exercises + Positive affirmations
                        </li>
                        <li style="padding: 10px; margin-bottom: 10px; background: white; border-radius: 8px; border-left: 4px solid var(--accent);">
                            <strong>‚òÄÔ∏è Midday (12-2 PM):</strong> Short walks + Thought reframing
                        </li>
                        <li style="padding: 10px; margin-bottom: 10px; background: white; border-radius: 8px; border-left: 4px solid var(--purple);">
                            <strong>üåô Evening (8-10 PM):</strong> Muscle relaxation + Gratitude practice
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal()">‚úï</button>
            <div id="modalBody"></div>
        </div>
    </div>

    <script>
        // User Data
        let userData = {
            level: 1,
            points: 0,
            streak: 0,
            dailyExercises: 0,
            weeklyExercises: 0,
            breathingCount: 0,
            thoughtsReframed: 0,
            squeezeCount: 0,
            completedExercises: [],
            moodHistory: [],
            activityTimes: []
        };

        // AI Recommendation Engine
        class AIRecommendationEngine {
            constructor() {
                this.recommendations = [
                    {
                        icon: 'ü´Å',
                        title: 'Box Breathing',
                        reason: 'Your stress levels are elevated today',
                        tip: 'Inhale for 4 counts, hold for 4, exhale for 4, hold for 4. This activates your parasympathetic nervous system.',
                        priority: 'high',
                        bestTime: 'Now'
                    },
                    {
                        icon: 'üí≠',
                        title: 'Thought Reframing',
                        reason: 'Pattern shows negative thought spiral',
                        tip: 'Challenge one negative thought by asking: Is this thought based on facts or feelings?',
                        priority: 'medium',
                        bestTime: 'Next 30 min'
                    },
                    {
                        icon: 'üéØ',
                        title: 'Stress Ball Exercise',
                        reason: 'Quick 2-minute anxiety reducer',
                        tip: '20-30 squeezes help release physical tension and ground you in the present moment.',
                        priority: 'high',
                        bestTime: 'Anytime'
                    },
                    {
                        icon: 'üßò',
                        title: 'Progressive Relaxation',
                        reason: 'You completed this yesterday with success',
                        tip: 'Tense each muscle group for 5 seconds, then release. Start with your feet and work up.',
                        priority: 'medium',
                        bestTime: 'Evening'
                    },
                    {
                        icon: 'üìù',
                        title: 'Gratitude Practice',
                        reason: 'Boosts mood by 23% on average',
                        tip: 'Write down 3 specific things you\'re grateful for today. Be detailed - "I\'m grateful for..." ',
                        priority: 'low',
                        bestTime: 'Before bed'
                    },
                    {
                        icon: 'üö∂',
                        title: '5-Minute Walk',
                        reason: 'Movement improves mood instantly',
                        tip: 'Even a short walk increases endorphins. Focus on your surroundings, not your phone.',
                        priority: 'medium',
                        bestTime: 'Midday'
                    }
                ];
            }

            getPersonalizedRecommendations(count = 3) {
                const hour = new Date().getHours();
                let scored = this.recommendations.map(rec => {
                    let score = 0;

                    // Time-based scoring
                    if (rec.bestTime === 'Now') score += 30;
                    if (rec.bestTime === 'Morning' && hour < 12) score += 20;
                    if (rec.bestTime === 'Evening' && hour >= 18) score += 20;
                    if (rec.bestTime === 'Anytime') score += 10;

                    // Priority scoring
                    if (rec.priority === 'high') score += 25;
                    if (rec.priority === 'medium') score += 15;
                    if (rec.priority === 'low') score += 5;

                    // Randomness for variety
                    score += Math.random() * 10;

                    return { ...rec, score };
                });

                return scored.sort((a, b) => b.score - a.score).slice(0, count);
            }
        }

        const aiEngine = new AIRecommendationEngine();

        // Initialize App
        function init() {
            loadData();
            updateUI();
            generateRecommendations();
            generateAIInsight();
            generateLearningPath();
            initializeMoodChart();
        }

        function loadData() {
            const saved = localStorage.getItem('mindcareAIData');
            if (saved) {
                userData = { ...userData, ...JSON.parse(saved) };
            }
        }

        function saveData() {
            localStorage.setItem('mindcareAIData', JSON.stringify(userData));
        }

        function updateUI() {
            document.getElementById('userLevel').textContent = userData.level;
            document.getElementById('userPoints').textContent = userData.points;
            document.getElementById('streakCount').textContent = userData.streak;
            document.getElementById('dailyExerciseCount').textContent = `${userData.dailyExercises}/3`;
            document.getElementById('weeklyExerciseCount').textContent = `${userData.weeklyExercises}/15`;

            const dailyPercent = (userData.dailyExercises / 3) * 100;
            const weeklyPercent = (userData.weeklyExercises / 15) * 100;

            document.getElementById('dailyProgressFill').style.width = `${Math.min(dailyPercent, 100)}%`;
            document.getElementById('weeklyProgressFill').style.width = `${Math.min(weeklyPercent, 100)}%`;

            saveData();
        }

        function generateRecommendations() {
            const recommendations = aiEngine.getPersonalizedRecommendations(3);
            const container = document.getElementById('recommendationGrid');

            container.innerHTML = recommendations.map(rec => `
                <div class="recommendation-card" onclick="handleRecommendation('${rec.title}')">
                    <div class="rec-badge">${rec.priority === 'high' ? '‚ö° BEST' : rec.priority === 'medium' ? 'üëç GOOD' : 'üí° TRY'}</div>
                    <div class="rec-icon">${rec.icon}</div>
                    <div class="rec-title">${rec.title}</div>
                    <div class="rec-reason">${rec.reason}</div>
                    <div class="ai-tip">${rec.tip}</div>
                    <div style="margin-top: 10px; font-size: 0.85em; color: var(--accent); font-weight: 600;">
                        ‚è∞ Best time: ${rec.bestTime}
                    </div>
                </div>
            `).join('');
        }

        function handleRecommendation(title) {
            const modal = document.getElementById('modal');
            const body = document.getElementById('modalBody');

            body.innerHTML = `
                <h2>${title}</h2>
                <p>Would you like to start this activity now?</p>
                <div style="margin-top: 20px; display: flex; gap: 10px;">
                    <button class="btn" onclick="startRecommendedActivity('${title}'); closeModal();">
                        ‚ñ∂Ô∏è Start Now
                    </button>
                    <button class="btn btn-secondary" onclick="closeModal()">
                        Maybe Later
                    </button>
                </div>
            `;
            modal.classList.add('active');
        }

        function startRecommendedActivity(title) {
            if (title.includes('Breathing')) {
                showSection('exercises');
                setTimeout(() => startBreathing(), 500);
            } else if (title.includes('Thought')) {
                showSection('exercises');
                document.getElementById('negativeThought').focus();
            } else if (title.includes('Stress Ball')) {
                showSection('games');
            } else if (title.includes('Relaxation')) {
                showSection('exercises');
                setTimeout(() => startPMR(), 500);
            }
        }

        // AI Insights
        function generateAIInsight() {
            const insights = [
                "Based on your patterns, you're 78% more likely to complete exercises in the morning. Try setting a 7 AM reminder!",
                "Your streak is strong! Users with 7+ day streaks report 40% better mood stability.",
                "Your breathing exercises are working well. Consider increasing from 3 to 5 rounds for even better results.",
                "You tend to skip exercises on Mondays. Let's break that pattern - we'll send you extra motivation tomorrow!",
                "Amazing! You're in the top 15% of users for consistency. Your commitment is paying off.",
                "Your thought reframing skills have improved 35% this week. Cognitive flexibility is building!",
                "Consider trying Progressive Muscle Relaxation before bed - your sleep quality data suggests you'd benefit.",
                "You complete exercises 2.3x more often when you do them right after breakfast. Use this trigger!"
            ];

            const randomInsight = insights[Math.floor(Math.random() * insights.length)];
            document.getElementById('aiInsightText').textContent = randomInsight;
        }

        function refreshInsight() {
            generateAIInsight();
            confetti({
                particleCount: 50,
                spread: 60,
                origin: { y: 0.3 }
            });
        }

        function explainInsight() {
            const modal = document.getElementById('modal');
            const body = document.getElementById('modalBody');

            body.innerHTML = `
                <h2>How AI Insights Work</h2>
                <p style="margin: 15px 0;">MindCare AI analyzes your activity patterns, completion times, and engagement data to generate personalized insights.</p>
                <h3>What we track:</h3>
                <ul style="padding-left: 20px; margin: 10px 0;">
                    <li>Best times for your exercises</li>
                    <li>Activity completion patterns</li>
                    <li>Streak maintenance behaviors</li>
                    <li>Effectiveness of different techniques</li>
                </ul>
                <div class="ai-tip mt-2">
                    All analysis happens locally on your device. Your privacy is protected.
                </div>
                <button class="btn mt-2" onclick="closeModal()">Got it!</button>
            `;
            modal.classList.add('active');
        }

        // Breathing Exercise
        let breathingInterval;
        let breathingState = 'ready';
        let breathingRoundCount = 0;
        let isPaused = false;

        const breathingTips = [
            "Focus on the cool air entering your nostrils and the warm air leaving.",
            "Place one hand on your chest and one on your belly - feel your diaphragm expand.",
            "If your mind wanders, gently bring attention back to your breath without judgment.",
            "You're doing great! Each breath is calming your nervous system.",
            "Try to make your exhale slightly longer than your inhale for maximum relaxation."
        ];

        function startBreathing() {
            const circle = document.getElementById('breathingCircle');
            const text = document.getElementById('breathingText');
            const startBtn = document.getElementById('startBreathing');
            const pauseBtn = document.getElementById('pauseBreathing');

            startBtn.disabled = true;
            pauseBtn.disabled = false;
            isPaused = false;

            let cycle = 0;
            const phases = ['Inhale', 'Hold', 'Exhale', 'Hold'];
            const durations = [4000, 4000, 4000, 4000];

            function breathCycle() {
                if (isPaused) return;

                const phase = phases[cycle % 4];
                text.textContent = phase;

                if (phase === 'Inhale') {
                    circle.classList.remove('exhale');
                    circle.classList.add('inhale');
                } else if (phase === 'Exhale') {
                    circle.classList.remove('inhale');
                    circle.classList.add('exhale');
                }

                // Update tip every few breaths
                if (cycle % 4 === 0) {
                    const tipIndex = Math.floor(Math.random() * breathingTips.length);
                    document.getElementById('breathingTip').textContent = breathingTips[tipIndex];
                }

                breathingInterval = setTimeout(() => {
                    cycle++;
                    if (cycle % 16 === 0) {
                        breathingRoundCount++;
                        document.getElementById('breathingRounds').textContent = breathingRoundCount;

                        if (breathingRoundCount >= 3) {
                            completeBreathing();
                            return;
                        }
                    }
                    breathCycle();
                }, durations[cycle % 4]);
            }

            breathCycle();
        }

        function pauseBreathing() {
            isPaused = true;
            clearTimeout(breathingInterval);
            document.getElementById('startBreathing').disabled = false;
            document.getElementById('pauseBreathing').disabled = true;
        }

        function resetBreathing() {
            clearTimeout(breathingInterval);
            breathingRoundCount = 0;
            isPaused = false;
            document.getElementById('breathingCircle').classList.remove('inhale', 'exhale');
            document.getElementById('breathingText').textContent = 'Ready';
            document.getElementById('breathingRounds').textContent = '0';
            document.getElementById('startBreathing').disabled = false;
            document.getElementById('pauseBreathing').disabled = true;
        }

        function completeBreathing() {
            resetBreathing();
            userData.dailyExercises++;
            userData.weeklyExercises++;
            userData.breathingCount++;
            userData.points += 15;
            updateUI();

            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 }
            });

            const modal = document.getElementById('modal');
            const body = document.getElementById('modalBody');
            body.innerHTML = `
                <h2>üéâ Exercise Complete!</h2>
                <p>Great job! You completed 3 rounds of breathing.</p>
                <div class="ai-tip mt-2">
                    You've earned 15 XP! Your parasympathetic nervous system is now activated,
                    which means your body is in "rest and digest" mode. Notice how you feel.
                </div>
                <button class="btn mt-2" onclick="closeModal()">Continue</button>
            `;
            modal.classList.add('active');
        }

        // Thought Reframing
        const reframingStrategies = [
            {
                pattern: /always|never|everyone|no one/i,
                reframe: (thought) => thought.replace(/always|never|everyone|no one/gi, match => {
                    const replacements = {
                        'always': 'sometimes',
                        'never': 'rarely',
                        'everyone': 'some people',
                        'no one': 'few people'
                    };
                    return replacements[match.toLowerCase()] || match;
                }),
                tip: "All-or-nothing thinking detected. Reality often exists in shades of gray."
            },
            {
                pattern: /can't|impossible|hopeless/i,
                reframe: (thought) => "What if: " + thought.replace(/can't/gi, "haven't yet").replace(/impossible/gi, "challenging").replace(/hopeless/gi, "difficult right now"),
                tip: "Fixed mindset detected. Try adopting a growth mindset - challenges are opportunities to learn."
            },
            {
                pattern: /should|must|have to/i,
                reframe: (thought) => thought.replace(/should|must|have to/gi, "could choose to"),
                tip: "Rigid expectations can create unnecessary pressure. Focus on preferences, not absolutes."
            }
        ];

        function reframeThought() {
            const thought = document.getElementById('negativeThought').value.trim();
            if (!thought) {
                alert('Please enter a thought first');
                return;
            }

            let reframed = thought;
            let tip = "Try to view this situation from a friend's perspective - what would you tell them?";

            for (let strategy of reframingStrategies) {
                if (strategy.pattern.test(thought)) {
                    reframed = strategy.reframe(thought);
                    tip = strategy.tip;
                    break;
                }
            }

            // Generic reframe if no pattern matched
            if (reframed === thought) {
                reframed = `Instead of "${thought}", consider: "This is one perspective, but there might be other ways to look at this situation."`;
                tip = "When stuck, ask yourself: What evidence supports this thought? What evidence contradicts it?";
            }

            document.getElementById('reframedThought').textContent = reframed;
            document.getElementById('reframeTip').textContent = tip;
            document.getElementById('reframeResult').classList.remove('hidden');

            userData.thoughtsReframed++;
            userData.points += 10;
            updateUI();
        }

        // Progressive Muscle Relaxation
        let pmrStep = 0;
        const pmrSteps = [
            { area: 'Feet & Toes', emoji: 'ü¶∂', instruction: 'Curl your toes tightly for 5 seconds', tip: 'Notice the difference between tension and relaxation' },
            { area: 'Legs & Thighs', emoji: 'ü¶µ', instruction: 'Squeeze your thigh muscles', tip: 'Feel the warmth as blood flows back into relaxed muscles' },
            { area: 'Hips & Buttocks', emoji: 'üí∫', instruction: 'Clench your buttocks firmly', tip: 'Breathe normally while holding the tension' },
            { area: 'Stomach', emoji: 'ü´É', instruction: 'Tighten your abdominal muscles', tip: 'Release slowly and feel your belly soften' },
            { area: 'Chest & Back', emoji: 'ü´Å', instruction: 'Pull shoulders back and expand chest', tip: 'This releases upper body tension beautifully' },
            { area: 'Arms & Hands', emoji: 'üí™', instruction: 'Make tight fists and tense biceps', tip: 'Your arms may feel heavy and warm when released' },
            { area: 'Shoulders & Neck', emoji: 'ü§∑', instruction: 'Raise shoulders to ears', tip: 'This area holds lots of stress - give it extra attention' },
            { area: 'Face', emoji: 'üòä', instruction: 'Scrunch your face tightly', tip: 'Finish by letting your jaw drop open and tongue rest gently' }
        ];

        function startPMR() {
            pmrStep = 0;
            nextPMRStep();
        }

        function nextPMRStep() {
            if (pmrStep >= pmrSteps.length) {
                completePMR();
                return;
            }

            const step = pmrSteps[pmrStep];
            document.getElementById('pmrEmoji').textContent = step.emoji;
            document.getElementById('pmrInstruction').textContent = step.instruction;
            document.getElementById('pmrArea').textContent = step.area;
            document.getElementById('pmrStep').textContent = pmrStep + 1;
            document.getElementById('pmrTip').textContent = step.tip;

            pmrStep++;
        }

        function resetPMR() {
            pmrStep = 0;
            document.getElementById('pmrEmoji').textContent = 'üßò';
            document.getElementById('pmrInstruction').textContent = 'Click start to begin';
            document.getElementById('pmrArea').textContent = 'Ready when you are';
            document.getElementById('pmrStep').textContent = '0';
        }

        function completePMR() {
            resetPMR();
            userData.dailyExercises++;
            userData.weeklyExercises++;
            userData.points += 20;
            updateUI();

            confetti({
                particleCount: 150,
                spread: 80,
                origin: { y: 0.6 }
            });

            showCompletionModal('Progressive Muscle Relaxation', 20, 'Your body is now in a deeply relaxed state. This technique reduces physical anxiety by up to 60%!');
        }

        // Stress Ball Game
        let squeezes = 0;

        function squeezeBall() {
            squeezes++;
            document.getElementById('squeezeCount').textContent = squeezes;

            // Update tips at milestones
            if (squeezes === 5) {
                document.getElementById('ballTip').textContent = 'Nice! Keep going. Repetitive motion helps regulate your nervous system.';
            } else if (squeezes === 10) {
                document.getElementById('ballTip').textContent = 'Halfway there! Notice how your shoulders might be relaxing.';
            } else if (squeezes === 20) {
                document.getElementById('ballTip').textContent = 'Perfect! 20 squeezes is the sweet spot for tension release.';
                userData.dailyExercises++;
                userData.weeklyExercises++;
                userData.points += 10;
                userData.squeezeCount += squeezes;
                updateUI();

                setTimeout(() => {
                    confetti({
                        particleCount: 80,
                        spread: 60,
                        origin: { y: 0.6 }
                    });
                    showCompletionModal('Stress Ball', 10, 'You\'ve released physical tension! The repetitive squeezing action activated your parasympathetic response.');
                }, 500);
            }
        }

        // Bubble Breathing Game
        let bubbleGame;
        let bubbleScore = 0;
        let bubbleCanvas;
        let bubbleCtx;

        function startBubbleGame() {
            bubbleCanvas = document.getElementById('bubbleCanvas');
            bubbleCtx = bubbleCanvas.getContext('2d');
            bubbleScore = 0;

            let phase = 'inhale';
            let radius = 50;
            let growing = true;

            bubbleGame = setInterval(() => {
                bubbleCtx.clearRect(0, 0, 400, 400);

                // Draw bubble
                bubbleCtx.beginPath();
                bubbleCtx.arc(200, 200, radius, 0, 2 * Math.PI);
                bubbleCtx.fillStyle = growing ?
                    'rgba(99, 102, 241, 0.3)' :
                    'rgba(139, 92, 246, 0.3)';
                bubbleCtx.fill();
                bubbleCtx.strokeStyle = 'white';
                bubbleCtx.lineWidth = 3;
                bubbleCtx.stroke();

                // Draw text
                bubbleCtx.fillStyle = 'white';
                bubbleCtx.font = 'bold 24px Arial';
                bubbleCtx.textAlign = 'center';
                bubbleCtx.fillText(growing ? 'Inhale' : 'Exhale', 200, 210);

                // Animate
                if (growing) {
                    radius += 2;
                    if (radius >= 150) {
                        growing = false;
                        bubbleScore += 10;
                        document.getElementById('bubbleScore').textContent = bubbleScore;
                    }
                } else {
                    radius -= 2;
                    if (radius <= 50) {
                        growing = true;
                    }
                }
            }, 50);
        }

        function stopBubbleGame() {
            clearInterval(bubbleGame);
            if (bubbleScore >= 50) {
                userData.dailyExercises++;
                userData.weeklyExercises++;
                userData.points += 15;
                updateUI();

                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });

                showCompletionModal('Bubble Breathing', 15, `Excellent breath control! You scored ${bubbleScore} points. Visual feedback helps train your breathing rhythm.`);
            }
        }

        // Learning Path Generation
        function generateLearningPath() {
            const learningModules = [
                {
                    title: 'üß† Why Deep Breathing Works',
                    content: 'Deep breathing activates the vagus nerve, which tells your brain to calm down. This is not placebo - it\'s a real physiological response that reduces cortisol (stress hormone) within 60 seconds.',
                    actionable: 'Next time you feel anxious, try 3 deep breaths before anything else. Notice what changes.',
                    unlocked: true
                },
                {
                    title: 'üí≠ Understanding Cognitive Distortions',
                    content: 'Your brain has shortcuts (heuristics) that sometimes lead to errors. Common ones: all-or-nothing thinking, catastrophizing, and mind reading. Recognizing these patterns is the first step to changing them.',
                    actionable: 'Pick one thought that bothered you today. Which cognitive distortion might it be? There\'s no wrong answer.',
                    unlocked: userData.thoughtsReframed >= 1
                },
                {
                    title: 'üò¥ The Sleep-Anxiety Loop',
                    content: 'Poor sleep increases anxiety by 30%. Anxiety disrupts sleep. It\'s a vicious cycle. Progressive Muscle Relaxation before bed can break this loop by physically relaxing your body.',
                    actionable: 'Tonight, try PMR 30 minutes before bed. Notice your sleep quality tomorrow morning.',
                    unlocked: userData.dailyExercises >= 2
                },
                {
                    title: 'üîÑ Building Lasting Habits',
                    content: 'Habits form through repetition + reward. You\'re already doing the repetition (great!). The reward is both the points you earn AND how you feel after. Notice that feeling - it\'s your brain\'s reward system at work.',
                    actionable: 'Try doing one exercise at the same time each day for a week. Your brain will start to crave it at that time.',
                    unlocked: userData.streak >= 3
                },
                {
                    title: 'üéØ The Power of Small Wins',
                    content: 'Research shows that small, consistent actions are more effective than occasional big efforts. Every exercise you complete is rewiring your brain\'s stress response. You\'re literally changing your neurology.',
                    actionable: 'Celebrate each small win today. Your brain learns better with positive reinforcement.',
                    unlocked: userData.weeklyExercises >= 5
                }
            ];

            const container = document.getElementById('learningContainer');
            container.innerHTML = learningModules.map((module, index) => {
                if (!module.unlocked) {
                    return `
                        <div class="learning-card" style="opacity: 0.6; cursor: not-allowed;">
                            <div class="learning-title">
                                üîí ${module.title}
                                <span style="font-size: 0.8em; font-weight: normal; color: var(--text-medium);">
                                    (Keep practicing to unlock)
                                </span>
                            </div>
                        </div>
                    `;
                }

                return `
                    <div class="learning-card" onclick="toggleLearning(${index})">
                        <div class="learning-title">
                            ${module.title}
                            <span style="font-size: 0.8em;">‚ñº</span>
                        </div>
                        <div class="learning-content" id="learning-${index}">
                            <p style="margin-bottom: 15px;">${module.content}</p>
                            <div class="ai-tip">
                                <strong>Try This:</strong> ${module.actionable}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function toggleLearning(index) {
            const content = document.getElementById(`learning-${index}`);
            const allContents = document.querySelectorAll('.learning-content');

            allContents.forEach((el, i) => {
                if (i !== index) el.classList.remove('active');
            });

            content.classList.toggle('active');
        }

        // Mood Chart
        function initializeMoodChart() {
            const ctx = document.getElementById('moodChart');
            if (!ctx) return;

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                    datasets: [{
                        label: 'Historical Mood',
                        data: [6.5, 7.0, 6.8, 7.2, 7.5, 7.8, 8.0],
                        borderColor: 'rgb(99, 102, 241)',
                        backgroundColor: 'rgba(99, 102, 241, 0.1)',
                        tension: 0.4
                    }, {
                        label: 'Predicted Mood',
                        data: [null, null, null, null, null, null, 8.0, 8.2, 8.3],
                        borderColor: 'rgb(16, 185, 129)',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        borderDash: [5, 5],
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 10,
                            ticks: {
                                stepSize: 2
                            }
                        }
                    }
                }
            });
        }

        // Navigation
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');
        }

        // Modal Functions
        function closeModal() {
            document.getElementById('modal').classList.remove('active');
        }

        function showCompletionModal(activityName, points, message) {
            const modal = document.getElementById('modal');
            const body = document.getElementById('modalBody');

            body.innerHTML = `
                <h2>üéâ ${activityName} Complete!</h2>
                <div style="text-align: center; font-size: 3em; margin: 20px 0;">‚ú®</div>
                <p style="font-size: 1.1em; margin: 15px 0;">+${points} XP</p>
                <div class="ai-tip mt-2">${message}</div>
                <button class="btn mt-2" onclick="closeModal()">Continue</button>
            `;
            modal.classList.add('active');
        }

        // Initialize on load
        window.addEventListener('load', init);

        // Close modal on outside click
        document.getElementById('modal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });
    </script>
</body>
</html>
